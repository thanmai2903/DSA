# Merge Sort

**Algorithm:**

-   Divide the array into two halves, sort each half, and merge the sorted halves.

**Time Complexity:**

-   Average and Worst-case: O(n log n)
-   Best-case: O(n log n)

**Space Complexity:**

-O(n) (not in-place sorting)

**C++ Code:**

```cpp
class Solution {
public:
    vector<int> sortArray(vector<int>& nums) {
        mergeSort(nums, 0, nums.size() - 1);
        return nums;
    }

private:
    void mergeSort(vector<int>& nums, int l, int h) {
        if (l >= h) return;
        int mid = l + (h - l) / 2;
        mergeSort(nums, l, mid);
        mergeSort(nums, mid + 1, h);
        merge(nums, l, mid, h);
    }

    void merge(vector<int>& nums, int l, int mid, int h) {
        vector<int> ans;
        int i = l, j = mid + 1;

        while (i <= mid && j <= h) {
            if (nums[i] <= nums[j]) {
                ans.push_back(nums[i++]);
            } else {
                ans.push_back(nums[j++]);
            }
        }

        while (i <= mid) {
            ans.push_back(nums[i++]);
        }

        while (j <= h) {
            ans.push_back(nums[j++]);
        }

        for (int k = l; k <= h; ++k) {
            nums[k] = ans[k - l];
        }
    }
};
```

### Way-2

```cpp
class Solution {
public:
    vector<int> sortArray(vector<int>& nums) {
        mergeSort(nums, 0, nums.size() - 1);
        return nums;
    }

    void mergeSort(vector<int>& nums, int l, int h) {
        if (l >= h) return;
        int mid = l + (h - l) / 2;
        mergeSort(nums, l, mid);
        mergeSort(nums, mid + 1, h);
        merge(nums, l, mid, h);
    }

    void merge(vector<int>& nums, int l, int mid, int h) {
        int n1 = mid - l + 1;
        int n2 = h - mid;
        vector<int> left(n1);
        vector<int> right(n2);

        for (int i = 0; i < n1; ++i)
            left[i] = nums[l + i];
        for (int i = 0; i < n2; ++i)
            right[i] = nums[mid + 1 + i];

        int i = 0, j = 0, k = l;
        while (i < n1 && j < n2) {
            if (left[i] <= right[j]) {
                nums[k++] = left[i++];
            } else {
                nums[k++] = right[j++];
            }
        }

        while (i < n1) {
            nums[k++] = left[i++];
        }

        while (j < n2) {
            nums[k++] = right[j++];
        }
    }
};
```

### Dry Run:

```less
Initial array: [5, 1, 4, 2, 8]
Divide: [5, 1, 4] and [2, 8]
Further divide: [5, 1], [4], [2], [8]
Sort and merge: [1, 5], [4], [2, 8]
Merge: [1, 4, 5], [2, 8]
Final merge: [1, 2, 4, 5, 8]
Sorted array: [1, 2, 4, 5, 8]
```
